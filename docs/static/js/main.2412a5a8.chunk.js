(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,a){e.exports=a(42)},42:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(23),i=a.n(o),c=a(11),s=a(45),l=a(8),m=a(9),d=a(12),u=a(10),v=a(13),p=a(46),h=a(43),f=a(15),E=a(7),g=function(){var e=(new Date).getFullYear();return n.a.createElement("footer",{className:"border-secondary border-top mb-3 pt-3 small text-center"},"\xa9 2017-",e,n.a.createElement("a",{className:"ml-1 text-danger",href:"http://saviomd.com/",target:"_blank",rel:"noopener noreferrer"},n.a.createElement("img",{alt:"saviomd.com",className:"mr-1",src:"https://saviomd.com/img/favicon.png",height:"15",width:"15"}),"S\xe1vio Mendes"))},b=a(44),y=a(5),N=function(e){var t=e.link;return n.a.createElement(b.a,{to:t.path,exact:!0,activeClassName:"active",className:"btn btn-danger btn-sm"},n.a.createElement(y.a,{icon:t.icon}),n.a.createElement("span",{className:"d-none d-sm-inline-block ml-1"},t.name))},D=function(e){var t=e.navLinks;return n.a.createElement("nav",{className:"btn-group"},t.map(function(e){return n.a.createElement(N,{key:e.path,link:e})}))},w=function(e){var t=e.navLinks;return n.a.createElement("header",{className:"border-bottom border-secondary mb-3"},n.a.createElement("div",{className:"align-items-center my-2 row"},n.a.createElement("h1",{className:"col-auto h5 mb-0"},n.a.createElement(b.a,{to:"/",exact:!0,className:"text-white"},"Movie Ratings")),n.a.createElement("div",{className:"col text-right"},n.a.createElement(D,{navLinks:t}))))},S=function(e){var t=e.type,a={error:{icon:"sad-tear",text:"An error has ocurred"},loading:{icon:"hourglass-half",text:"Loading..."},noMovies:{icon:"frown",text:"No movies to show"},noStats:{icon:"frown",text:"No stats to show"},pageNotFound:{icon:"dizzy",text:"Page not found"}};return n.a.createElement("div",{className:"lead p-3 text-center"},n.a.createElement("div",{className:"h3 mb-3"},n.a.createElement("span",{className:"bg-secondary p-2 rounded"},n.a.createElement(y.a,{icon:a[t].icon}))),a[t].text)},_=function(e){var t=e.movieInfo;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"p-3"},n.a.createElement("p",{className:"lead"},t.overview),n.a.createElement("div",{className:"text-right"},n.a.createElement("div",{className:"mb-3"},n.a.createElement("a",{className:"btn btn-danger btn-sm",href:t.LetterboxdURI,target:"_blank",rel:"noopener noreferrer"},"View movie at Letterboxd")),n.a.createElement("div",{className:"mb-3"},n.a.createElement("a",{className:"btn btn-danger btn-sm",href:"https://www.themoviedb.org/movie/".concat(t.id),target:"_blank",rel:"noopener noreferrer"},"View movie at TMDB")))),n.a.createElement("img",{alt:"backdrop for ".concat(t.title),className:"img-fluid rounded-bottom",src:t.backdrop_url}))},R=function(e){var t=e.movieInfo;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"p-3 row"},n.a.createElement("div",{className:"col-6 col-sm-4"},n.a.createElement("img",{alt:"poster for ".concat(t.title),className:"img-fluid",src:t.poster_url})),n.a.createElement("div",{className:"col-6 col-sm-8 text-right"},n.a.createElement("div",{className:"mb-3"},t.Rating," of 5",n.a.createElement(y.a,{className:"ml-1 text-warning",icon:"star"}),n.a.createElement("div",{className:"small"},"by me")),n.a.createElement("div",{className:"mb-3"},t.vote_average," of 10",n.a.createElement(y.a,{className:"ml-1 text-warning",icon:"star"}),n.a.createElement("div",{className:"small"},"by TMDb users")))),n.a.createElement("h1",{className:"bg-secondary h3 mb-0 p-3"},t.title))},O=function(e){var t=e.movieInfo;return n.a.createElement("div",{className:"border border-secondary rounded"},n.a.createElement(R,{movieInfo:t}),n.a.createElement(_,{movieInfo:t}))},I=a(4),x={attributionUrl:"https://www.themoviedb.org/assets/1/v4/logos/408x161-powered-by-rectangle-green-bb4301c10ddc749b4e79463811a68afebeae66ef43d17bcfd8ff0e60ded7ce99.png",baseUrl:"https://image.tmdb.org/t/p/",backdropSize:"w1280",fallbackUrl:"https://www.themoviedb.org/static_cache/v4/logos/293x302-powered-by-square-blue-ee05c47ab249273a6f9f1dcafec63daba386ca30544567629deb1809395d8516.png",posterSize:"w780"},k="api_key=6f875d4fba2e999f480afa6275a08f75",M="search/movie",P="https://api.themoviedb.org/3/";function T(e){return e.reverse(),e=e.map(function(e,t){return e.Id=e.LetterboxdURI.length?e.LetterboxdURI.split("/film/")[1].split("/")[0]:t.toString(),e.Name=e.Name.toString(),e.DateFormatted=new Date(e.Date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),e.WatchedDate&&(e.WatchedDateFormatted=new Date(e.WatchedDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})),e})}var A={groups:{},max:0},j=function(e){return{type:"MOVIES_PER_DECADE_RELEASED_UPDATE",payload:e}},U={groups:{},max:0},L=function(e){return{type:"MOVIES_PER_RATING_GIVEN_UPDATE",payload:e}},V={list:[],listStatus:""},C=function(){return function(e,t){return t().movieRatings.list.length?new Promise(function(e){return e(t().movieRatings.list)}):(e(Y("loading")),fetch("https://saviomd.com/movieratings/data/ratings.json").then(function(e){if(!e.ok)throw Error(e.status);return e.json()}).then(function(t){var a=T(t);return e(G(a)),e(function(e){return function(t,a){var r=e.reduce(function(e,t){var a="".concat(t.Year.toString().substr(0,3),"0");return e[a]?e[a]++:e[a]=1,e},{}),n=0;for(var o in r)n=r[o]>n?r[o]:n;t(j({groups:r,max:n}))}}(a)),e(function(e){return function(t,a){var r=e.reduce(function(e,t){var a=t.Rating;return e[a]?e[a]++:e[a]=1,e},{}),n=0;for(var o in r)n=r[o]>n?r[o]:n;t(L({groups:r,max:n}))}}(a)),a}).catch(function(t){e(Y("error")),console.log(t.message)}))}},G=function(e){return{type:"MOVIE_RATINGS_UPDATE",payload:e}},Y=function(e){return{type:"MOVIE_RATINGS_STATUS_UPDATE",payload:e}},F={backdrop_url:x.fallbackUrl,dataStatus:"",id:"",LetterboxdURI:"",overview:"",poster_url:x.fallbackUrl,Rating:"",title:"",vote_average:""},W=function(e){return{type:"MOVIE_INFO_UPDATE",payload:e}},z=function(e){return{type:"MOVIE_INFO_STATUS_UPDATE",payload:e}},B=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.loadMovieInfo(this.props.match.params.movieId)}},{key:"render",value:function(){var e=this.props.movieInfo,t="";return"loading"===e.dataStatus?t=n.a.createElement(S,{type:"loading"}):"error"===e.dataStatus?t=n.a.createElement(S,{type:"error"}):""!==e.id&&(t=n.a.createElement(O,{movieInfo:e})),n.a.createElement("div",{className:"mb-3"},t)}}]),t}(n.a.Component),q=Object(c.b)(function(e){return{movieInfo:e.movieInfo}},{loadMovieInfo:function(e){return function(t,a){t(C()).then(function(r){t(z("loading"));var n,o=r.find(function(t){return t.Id===e});void 0!==o&&(n=o,fetch("".concat(P).concat(M,"?").concat(k,"&query=").concat(n.Name,"&year=").concat(n.Year)).then(function(e){if(!e.ok)throw Error(e.status);return e.json()})).then(function(e){if(!e.results.length)throw Error("No movie found");var r=e.results.find(function(e){return e.title===o.Name&&e.release_date.indexOf(o.Year)>-1});if(void 0===r)throw Error("No movie found");var n=Object(I.a)({},a().movieInfo,{backdrop_url:x.baseUrl+x.backdropSize+r.backdrop_path,dataStatus:"loaded",id:r.id,LetterboxdURI:o.LetterboxdURI,overview:r.overview,poster_url:x.baseUrl+x.posterSize+r.poster_path,Rating:o.Rating,title:r.title,vote_average:r.vote_average});t(W(n))}).catch(function(e){t(z("error")),console.log(e.message)})}).catch(function(e){t(z("error")),console.log(e.message)})}}})(B),H=a(39),J=function(e){var t,a=e.movie,r=e.type;"Diary"===r?t="watched in ".concat(a.WatchedDateFormatted):"Ratings"===r&&(t="rated in ".concat(a.DateFormatted));for(var o=[],i=0;i<a.Rating;i++)o.push(n.a.createElement(y.a,{key:i,className:"mr-1",icon:"star"}));return n.a.createElement(H.a,{className:"btn btn-secondary btn-block",to:"/movie/".concat(a.Id)},n.a.createElement("div",{className:"text-left text-truncate"},a.Name,n.a.createElement("span",{className:"ml-1 small"},"(",a.Year,")")),n.a.createElement("div",{className:"align-items-end row small"},n.a.createElement("div",{className:"col text-left text-warning"},o),n.a.createElement("div",{className:"col small text-right"},t)))},$=function(e){var t=e.movies,a=e.type;return n.a.createElement("ul",{className:"list-unstyled"},t.map(function(e){return n.a.createElement("li",{className:"mb-3",key:e.Id},n.a.createElement(J,{movie:e,type:a}))}))},K=function(e){var t=e.handleOnChangeMovieNameSearch,a=e.movieCount,r=e.movieSearchString;return n.a.createElement("div",{className:"mb-3"},n.a.createElement("div",{className:"input-group input-group-sm mb-1"},n.a.createElement("input",{id:"search-movie",className:"form-control",placeholder:"Search...",type:"text",value:r,onChange:function(e){return t(e.target.value)}}),n.a.createElement("span",{className:"input-group-append"},n.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return t("")}},n.a.createElement(y.a,{icon:"times"})))),n.a.createElement("p",{className:"small text-right"},a," movies"))};var Q={groups:{},max:0},X=function(e){return{type:"MOVIES_PER_YEAR_WATCHED_UPDATE",payload:e}},Z={list:[],listStatus:""},ee=function(){return function(e,t){return t().movieDiary.list.length?new Promise(function(e){return e(t().movieDiary.list)}):(e(ae("loading")),fetch("https://saviomd.com/movieratings/data/diary.json").then(function(e){if(!e.ok)throw Error(e.status);return e.json()}).then(function(t){var a=T(t);return e(te(a)),e(function(e){return function(t,a){var r=e.reduce(function(e,t){var a=t.WatchedDate.split("-")[0];return e[a]?e[a]++:e[a]=1,e},{}),n=0;for(var o in r)n=r[o]>n?r[o]:n;t(X({groups:r,max:n}))}}(a)),a}).catch(function(t){e(ae("error")),console.log(t.message)}))}},te=function(e){return{type:"MOVIE_DIARY_UPDATE",payload:e}},ae=function(e){return{type:"MOVIE_DIARY_STATUS_UPDATE",payload:e}},re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).handleOnChangeMovieNameSearch=function(e){e.trim().toLowerCase(),a.setState({movieSearchString:e})},a.state={movieSearchString:""},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){"Diary"===this.props.type?this.props.loadMovieDiary():"Ratings"===this.props.type&&this.props.loadMovieRatings()}},{key:"componentDidUpdate",value:function(e){this.props.type!==e.type&&("Diary"===this.props.type?this.props.loadMovieDiary():"Ratings"===this.props.type&&this.props.loadMovieRatings())}},{key:"render",value:function(){var e,t=this.props,a=t.movieDiary,r=t.movieRatings,o=t.type;"Diary"===o?e=a:"Ratings"===o&&(e=r);var i,c,s=(i=e.list,c=this.state.movieSearchString,i.filter(function(e){return e.Name.toLowerCase().includes(c.toLowerCase())})),l=e.listStatus,m="";return m="loading"===l||"error"===l?n.a.createElement(S,{type:l}):s.length?n.a.createElement($,{movies:s,type:o}):n.a.createElement(S,{type:"noMovies"}),n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"h4"},o),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12 col-sm-4"},n.a.createElement(K,{handleOnChangeMovieNameSearch:this.handleOnChangeMovieNameSearch,movieCount:s.length,movieSearchString:this.state.movieSearchString})),n.a.createElement("div",{className:"col-12 col-sm-8"},m)))}}]),t}(n.a.Component),ne=Object(c.b)(function(e){return{movieDiary:e.movieDiary,movieRatings:e.movieRatings}},{loadMovieDiary:ee,loadMovieRatings:C})(re),oe=function(e){e.messages;return n.a.createElement(S,{type:"pageNotFound"})},ie=function(e){var t=e.width;return n.a.createElement("div",{className:"bg-secondary rounded"},n.a.createElement("div",{className:"bg-danger pb-2 rounded",style:{width:"".concat(t,"%")}}))},ce=function(e){var t=e.movies,a=e.source,r=e.type,o=[];if("loading"===a.listStatus||"error"===a.listStatus)o.push(n.a.createElement(S,{key:a.listStatus,type:a.listStatus}));else if(t.groups){var i=function(e){var a=100*t.groups[e]/t.max;o.unshift(n.a.createElement("div",{className:"mb-2",key:e},n.a.createElement("div",{className:"no-gutters row"},n.a.createElement("div",{className:"col-auto"},function(){if("moviesPerRatingGiven"===r){for(var t=[],a=0;a<e;a++)t.push(n.a.createElement(y.a,{key:a,className:"mr-1 text-warning",icon:"star"}));return t}return e}()),n.a.createElement("div",{className:"col font-weight-bold text-right"},t.groups[e])),n.a.createElement(ie,{width:a})))};for(var c in t.groups)i(c)}else o.push(n.a.createElement(S,{key:"noStats",type:"noStats"}));return o},se=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.loadMovieDiary(),this.props.loadMovieRatings()}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"h4"},"Stats"),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per year watched"),n.a.createElement(ce,{movies:this.props.moviesPerYearWatched,source:this.props.movieDiary,type:"moviesPerYearWatched"}))),n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per rating given"),n.a.createElement(ce,{movies:this.props.moviesPerRatingGiven,source:this.props.movieRatings,type:"moviesPerRatingGiven"}))),n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per decade released"),n.a.createElement(ce,{movies:this.props.moviesPerDecadeReleased,source:this.props.movieRatings,type:"moviesPerDecadeReleased"})))))}}]),t}(n.a.Component),le=Object(c.b)(function(e){return{movieDiary:e.movieDiary,movieRatings:e.movieRatings,moviesPerDecadeReleased:e.moviesPerDecadeReleased,moviesPerRatingGiven:e.moviesPerRatingGiven,moviesPerYearWatched:e.moviesPerYearWatched}},{loadMovieDiary:ee,loadMovieRatings:C})(se),me=function(){return n.a.createElement("div",{className:"border-secondary border-top pt-3 small text-center"},n.a.createElement("div",{className:"mb-3"},"My Ratings and Diary data are exported from Letterboxd from time to time.",n.a.createElement("br",null),"So my ",n.a.createElement("a",{className:"text-danger",href:"https://letterboxd.com/saviomd",target:"_blank",rel:"noopener noreferrer"},"profile")," will have more up to date information."),n.a.createElement("div",{className:"mb-3"},n.a.createElement("img",{alt:"Powered by TMDB",className:"mr-1",src:x.attributionUrl,height:"32"}),n.a.createElement("br",null),"This product uses the TMDb API but is not endorsed or certified by TMDb."))};a(40);f.b.add(E.a,E.b,E.c,E.d,E.e,E.f,E.g,E.h);var de=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={navLinks:[{icon:"star",name:"Ratings",path:"/"},{icon:"calendar-alt",name:"Diary",path:"/diary"},{icon:"chart-bar",name:"Stats",path:"/stats"}]},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"justify-content-center row"},n.a.createElement("div",{className:"col-12 col-md-10"},n.a.createElement(w,{navLinks:this.state.navLinks}),n.a.createElement(p.a,null,n.a.createElement(h.a,{path:"/",exact:!0,render:function(){return n.a.createElement(ne,{type:"Ratings"})}}),n.a.createElement(h.a,{path:"/diary",render:function(){return n.a.createElement(ne,{type:"Diary"})}}),n.a.createElement(h.a,{path:"/movie/:movieId",render:function(e){var t=e.match;return n.a.createElement(q,{match:t})}}),n.a.createElement(h.a,{path:"/stats",render:function(){return n.a.createElement(le,null)}}),n.a.createElement(h.a,{component:oe})),n.a.createElement(me,null),n.a.createElement(g,null))))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=a(14),ve=a(27),pe=a(28),he=Object(ue.combineReducers)({movieDiary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIE_DIARY_UPDATE":return Object(I.a)({},e,{list:t.payload,listStatus:"loaded"});case"MOVIE_DIARY_STATUS_UPDATE":return Object(I.a)({},e,{listStatus:t.payload});default:return e}},movieInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIE_INFO_UPDATE":return t.payload;case"MOVIE_INFO_STATUS_UPDATE":return Object(I.a)({},e,{dataStatus:t.payload});default:return e}},movieRatings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIE_RATINGS_UPDATE":return Object(I.a)({},e,{list:t.payload,listStatus:"loaded"});case"MOVIE_RATINGS_STATUS_UPDATE":return Object(I.a)({},e,{listStatus:t.payload});default:return e}},moviesPerDecadeReleased:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIES_PER_DECADE_RELEASED_UPDATE":var a=t.payload,r=a.groups,n=a.max;return Object(I.a)({},e,{groups:r,max:n});default:return e}},moviesPerRatingGiven:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIES_PER_RATING_GIVEN_UPDATE":var a=t.payload,r=a.groups,n=a.max;return Object(I.a)({},e,{groups:r,max:n});default:return e}},moviesPerYearWatched:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVIES_PER_YEAR_WATCHED_UPDATE":var a=t.payload,r=a.groups,n=a.max;return Object(I.a)({},e,{groups:r,max:n});default:return e}}}),fe=Object(ue.createStore)(he,Object(ve.composeWithDevTools)(Object(ue.applyMiddleware)(pe.a))),Ee=n.a.createElement(c.a,{store:fe},n.a.createElement(s.a,null,n.a.createElement(de,null)));i.a.render(Ee,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,2,1]]]);
//# sourceMappingURL=main.2412a5a8.chunk.js.map