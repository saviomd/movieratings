(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,a){e.exports=a(32)},32:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(18),o=a.n(i),s=a(35),c=a(7),l=a(8),m=a(10),v=a(9),u=a(11),d=a(36),g=a(33),h=a(13),f=a(12),b=a(3),p=n.a.createContext(),E=p.Consumer,y=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(v.a)(t).call(this,e))).state={movieSearchString:""},a.setMovieSearchString=a.setMovieSearchString.bind(Object(b.a)(Object(b.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setMovieSearchString",value:function(e){e.trim().toLowerCase(),this.setState({movieSearchString:e})}},{key:"render",value:function(){var e=this.props.children,t=this.state.movieSearchString;return n.a.createElement(p.Provider,{value:{setMovieSearchString:this.setMovieSearchString,movieSearchString:t}},e)}}]),t}(n.a.Component);function N(e,t){return e.filter(function(e){return e.Name.toLowerCase().includes(t.toLowerCase())})}function S(e){return e.reverse(),e=e.map(function(e,t){return e.Id=e.LetterboxdURI.length?e.LetterboxdURI.split("/film/")[1].split("/")[0]:t.toString(),e.Name=e.Name.toString(),e.DateFormatted=new Date(e.Date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),e.WatchedDate&&(e.WatchedDateFormatted=new Date(e.WatchedDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})),e})}var M=n.a.createContext(),R=M.Consumer,w=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(v.a)(t).call(this,e))).state={movieDiary:[],movieDiaryPage:1,movieDiaryStatus:""},a.increaseMovieDiaryPage=a.increaseMovieDiaryPage.bind(Object(b.a)(Object(b.a)(a))),a.getMoviesPerYearWatched=a.getMoviesPerYearWatched.bind(Object(b.a)(Object(b.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadMovieDiary()}},{key:"getMoviesFiltered",value:function(){var e=this.context.movieSearchString;return N(this.state.movieDiary,e)}},{key:"getMoviesPaginated",value:function(){var e=100*this.state.movieDiaryPage;return this.getMoviesFiltered().slice(0,e)}},{key:"getMoviesPerYearWatched",value:function(){var e=this.state.movieDiary.reduce(function(e,t){var a=t.WatchedDate.split("-")[0];return e[a]?e[a]++:e[a]=1,e},{}),t=0;for(var a in e)t=e[a]>t?e[a]:t;return{groups:e,max:t}}},{key:"increaseMovieDiaryPage",value:function(){var e=this.state.movieDiaryPage;this.setState({movieDiaryPage:e+1})}},{key:"loadMovieDiary",value:function(){var e=this;return this.setState({movieDiaryStatus:"loading"}),fetch("https://saviomd.com/movieratings/data/diary.json").then(function(e){if(!e.ok)throw Error(e.status);return e.json()}).then(function(t){var a=S(t);return e.setState({movieDiary:a,movieDiaryStatus:"loaded"}),a}).catch(function(t){e.setState({movieDiaryStatus:"error"}),console.log(t.message)})}},{key:"render",value:function(){var e=this.props.children,t=this.state,a=t.movieDiary,r=t.movieDiaryStatus;return n.a.createElement(M.Provider,{value:{getMoviesPerYearWatched:this.getMoviesPerYearWatched,increaseMovieDiaryPage:this.increaseMovieDiaryPage,movieDiary:a,movieDiaryFiltered:this.getMoviesFiltered(),movieDiaryPaginated:this.getMoviesPaginated(),movieDiaryStatus:r}},e)}}]),t}(n.a.Component);w.contextType=p;var D=n.a.createContext(),P=D.Consumer,k=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(v.a)(t).call(this,e))).state={movieRatings:[],movieRatingsPage:1,movieRatingsStatus:""},a.increaseMovieRatingsPage=a.increaseMovieRatingsPage.bind(Object(b.a)(Object(b.a)(a))),a.getMoviesPerDecadeReleased=a.getMoviesPerDecadeReleased.bind(Object(b.a)(Object(b.a)(a))),a.getMoviesPerRatingGiven=a.getMoviesPerRatingGiven.bind(Object(b.a)(Object(b.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadMovieRatings()}},{key:"getMoviesFiltered",value:function(){var e=this.context.movieSearchString;return N(this.state.movieRatings,e)}},{key:"getMoviesPaginated",value:function(){var e=100*this.state.movieRatingsPage;return this.getMoviesFiltered().slice(0,e)}},{key:"getMoviesPerDecadeReleased",value:function(){var e=this.state.movieRatings.reduce(function(e,t){var a="".concat(t.Year.toString().substr(0,3),"0");return e[a]?e[a]++:e[a]=1,e},{}),t=0;for(var a in e)t=e[a]>t?e[a]:t;return{groups:e,max:t}}},{key:"getMoviesPerRatingGiven",value:function(){var e=this.state.movieRatings.reduce(function(e,t){var a=t.Rating;return e[a]?e[a]++:e[a]=1,e},{}),t=0;for(var a in e)t=e[a]>t?e[a]:t;return{groups:e,max:t}}},{key:"increaseMovieRatingsPage",value:function(){var e=this.state.movieRatingsPage;this.setState({movieRatingsPage:e+1})}},{key:"loadMovieRatings",value:function(){var e=this;return this.setState({movieRatingsStatus:"loading"}),fetch("https://saviomd.com/movieratings/data/ratings.json").then(function(e){if(!e.ok)throw Error(e.status);return e.json()}).then(function(t){var a=S(t);return e.setState({movieRatings:a,movieRatingsStatus:"loaded"}),a}).catch(function(t){e.setState({movieRatingsStatus:"error"}),console.log(t.message)})}},{key:"render",value:function(){var e=this.props.children,t=this.state,a=t.movieRatings,r=t.movieRatingsStatus;return n.a.createElement(D.Provider,{value:{getMoviesPerDecadeReleased:this.getMoviesPerDecadeReleased,getMoviesPerRatingGiven:this.getMoviesPerRatingGiven,increaseMovieRatingsPage:this.increaseMovieRatingsPage,movieRatings:a,movieRatingsFiltered:this.getMoviesFiltered(),movieRatingsPaginated:this.getMoviesPaginated(),movieRatingsStatus:r}},e)}}]),t}(n.a.Component);k.contextType=p;var x=function(){var e=(new Date).getFullYear();return n.a.createElement("footer",{className:"border-secondary border-top mb-3 pt-3 small text-center"},"\xa9 2017-",e,n.a.createElement("a",{className:"ml-1 text-danger",href:"http://saviomd.com/",target:"_blank",rel:"noopener noreferrer"},n.a.createElement("img",{alt:"saviomd.com",className:"mr-1",src:"https://saviomd.com/img/favicon.png",height:"15",width:"15"}),"S\xe1vio Mendes"))},j=a(34),O=a(4),I=function(e){var t=e.link;return n.a.createElement(j.a,{to:t.path,exact:!0,activeClassName:"active",className:"btn btn-danger btn-sm"},n.a.createElement(O.a,{icon:t.icon}),n.a.createElement("span",{className:"d-none d-sm-inline-block ml-1"},t.name))},F=function(e){var t=e.navLinks;return n.a.createElement("nav",{className:"btn-group"},t.map(function(e){return n.a.createElement(I,{key:e.path,link:e})}))},C=function(e){var t=e.navLinks;return n.a.createElement("header",{className:"border-bottom border-secondary mb-3"},n.a.createElement("div",{className:"align-items-center my-2 row"},n.a.createElement("h1",{className:"col-auto h5 mb-0"},n.a.createElement(j.a,{to:"/",exact:!0,className:"text-white"},"Movie Ratings")),n.a.createElement("div",{className:"col text-right"},n.a.createElement(F,{navLinks:t}))))},L={img:{attributionUrl:"https://www.themoviedb.org/assets/1/v4/logos/408x161-powered-by-rectangle-green-bb4301c10ddc749b4e79463811a68afebeae66ef43d17bcfd8ff0e60ded7ce99.png",baseUrl:"https://image.tmdb.org/t/p/",backdropSize:"w1280",fallbackUrl:"https://www.themoviedb.org/assets/1/v4/logos/293x302-powered-by-square-blue-ee05c47ab249273a6f9f1dcafec63daba386ca30544567629deb1809395d8516.png",posterSize:"w780"},key:"api_key=6f875d4fba2e999f480afa6275a08f75",pathSearchMovies:"search/movie",url:"https://api.themoviedb.org/3/"},_=n.a.createContext(),U=_.Consumer,W=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(v.a)(t).call(this,e))).state={movieInfo:{backdrop_url:L.img.fallbackUrl,id:"",LetterboxdURI:"",overview:"",poster_url:L.img.fallbackUrl,Rating:"",title:"",vote_average:""},movieInfoStatus:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadMovieInfo(this.props.movie)}},{key:"componentDidUpdate",value:function(e){this.props.movie!==e.movie&&this.loadMovieInfo(this.props.movie)}},{key:"loadMovieInfo",value:function(e){var t=this;void 0!==e&&(this.setState({movieInfoStatus:"loading"}),function(e){return fetch("".concat(L.url).concat(L.pathSearchMovies,"?").concat(L.key,"&query=").concat(e.Name,"&year=").concat(e.Year)).then(function(e){if(!e.ok)throw Error(e.status);return e.json()})}(e).then(function(a){if(!a.results.length)throw Error("No movie found");var r=a.results.find(function(t){return t.title===e.Name&&t.release_date.indexOf(e.Year)>-1});if(void 0===r)throw Error("No movie found");t.setState({movieInfoStatus:"loaded",movieInfo:{backdrop_url:L.img.baseUrl+L.img.backdropSize+r.backdrop_path,id:r.id,LetterboxdURI:e.LetterboxdURI,overview:r.overview,poster_url:L.img.baseUrl+L.img.posterSize+r.poster_path,Rating:e.Rating,title:r.title,vote_average:r.vote_average}})}).catch(function(e){t.setState({movieInfoStatus:"error"}),console.log(e.message)}))}},{key:"render",value:function(){var e=this.props.children,t=this.state,a=t.movieInfo,r=t.movieInfoStatus;return n.a.createElement(_.Provider,{value:{movieInfo:a,movieInfoStatus:r}},e)}}]),t}(n.a.Component),Y=function(e){var t=e.type,a={error:{icon:"sad-tear",text:"An error has ocurred"},loading:{icon:"hourglass-half",text:"Loading..."},noMovies:{icon:"frown",text:"No movies to show"},noStats:{icon:"frown",text:"No stats to show"},pageNotFound:{icon:"dizzy",text:"Page not found"}};return n.a.createElement("div",{className:"lead p-3 text-center"},n.a.createElement("div",{className:"h3 mb-3"},n.a.createElement("span",{className:"bg-secondary p-2 rounded"},n.a.createElement(O.a,{icon:a[t].icon}))),a[t].text)},G=function(){return n.a.createElement(U,null,function(e){var t=e.movieInfo;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"p-3"},n.a.createElement("p",{className:"lead"},t.overview),n.a.createElement("div",{className:"text-right"},n.a.createElement("div",{className:"mb-3"},n.a.createElement("a",{className:"btn btn-danger btn-sm",href:t.LetterboxdURI,target:"_blank",rel:"noopener noreferrer"},"View movie at Letterboxd")),n.a.createElement("div",{className:"mb-3"},n.a.createElement("a",{className:"btn btn-danger btn-sm",href:"https://www.themoviedb.org/movie/".concat(t.id),target:"_blank",rel:"noopener noreferrer"},"View movie at TMDB")))),n.a.createElement("img",{alt:"backdrop for ".concat(t.title),className:"img-fluid rounded-bottom",src:t.backdrop_url}))})},T=function(){return n.a.createElement(U,null,function(e){var t=e.movieInfo;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"p-3 row"},n.a.createElement("div",{className:"col-6 col-sm-4"},n.a.createElement("img",{alt:"poster for ".concat(t.title),className:"img-fluid",src:t.poster_url})),n.a.createElement("div",{className:"col-6 col-sm-8 text-right"},n.a.createElement("div",{className:"mb-3"},t.Rating," of 5",n.a.createElement(O.a,{className:"ml-1 text-warning",icon:"star"}),n.a.createElement("div",{className:"small"},"by me")),n.a.createElement("div",{className:"mb-3"},t.vote_average," of 10",n.a.createElement(O.a,{className:"ml-1 text-warning",icon:"star"}),n.a.createElement("div",{className:"small"},"by TMDb users")))),n.a.createElement("h1",{className:"bg-secondary h3 mb-0 p-3"},t.title))})},z=function(){return n.a.createElement(U,null,function(e){var t,a=e.movieInfo,r=e.movieInfoStatus;return"loaded"===r&&""!==a.id?t=n.a.createElement("div",{className:"border border-secondary mb-3 rounded"},n.a.createElement(T,null),n.a.createElement(G,null)):"loading"===r?t=n.a.createElement(Y,{type:"loading"}):"error"===r&&(t=n.a.createElement(Y,{type:"error"})),t})},B=function(e){var t=e.match;return n.a.createElement(P,null,function(e){var a=e.movieRatings,r=e.movieRatingsStatus;if("loaded"===r){var i=t.params.movieId,o=a.find(function(e){return e.Id===i});return n.a.createElement(W,{movie:o},n.a.createElement(z,null))}return"loading"===r?n.a.createElement(Y,{type:"loading"}):"error"===r?n.a.createElement(Y,{type:"error"}):void 0})},q=a(29),A=function(e){var t,a=e.movie,r=e.type;"Diary"===r?t="watched in ".concat(a.WatchedDateFormatted):"Ratings"===r&&(t="rated in ".concat(a.DateFormatted));for(var i=[],o=0;o<a.Rating;o++)i.push(n.a.createElement(O.a,{key:o,className:"mr-1",icon:"star"}));return n.a.createElement(q.a,{className:"btn btn-secondary btn-block",to:"/movie/".concat(a.Id)},n.a.createElement("div",{className:"text-left text-truncate"},a.Name,n.a.createElement("span",{className:"ml-1 small"},"(",a.Year,")")),n.a.createElement("div",{className:"align-items-end row small"},n.a.createElement("div",{className:"col text-left text-warning"},i),n.a.createElement("div",{className:"col small text-right"},t)))},J=function(e){var t,a=e.increasePage,r=e.moviesFiltered,i=e.moviesPaginated,o=e.moviesStatus,s=e.type;return"loaded"===o&&r.length?t=n.a.createElement(n.a.Fragment,null,n.a.createElement("ul",{className:"list-unstyled"},i.map(function(e){return n.a.createElement("li",{className:"mb-3",key:e.Id},n.a.createElement(A,{movie:e,type:s}))})),i.length<r.length&&n.a.createElement("div",{className:"mb-3 text-center"},n.a.createElement("button",{className:"btn btn-danger",type:"button",onClick:a},"Show more"))):"loaded"!==o||r.length?"loading"!==o&&"error"!==o||(t=n.a.createElement(Y,{type:o})):t=n.a.createElement(Y,{type:"noMovies"}),t},V=function(e){var t=e.type;return n.a.createElement(n.a.Fragment,null,"Diary"===t&&n.a.createElement(R,null,function(e){var a=e.increaseMovieDiaryPage,r=e.movieDiaryFiltered,n=e.movieDiaryPaginated,i=e.movieDiaryStatus;return J({increasePage:a,moviesFiltered:r,moviesPaginated:n,moviesStatus:i,type:t})}),"Ratings"===t&&n.a.createElement(P,null,function(e){var a=e.increaseMovieRatingsPage,r=e.movieRatingsFiltered,n=e.movieRatingsPaginated,i=e.movieRatingsStatus;return J({increasePage:a,moviesFiltered:r,moviesPaginated:n,moviesStatus:i,type:t})}))},$=function(e){var t=e.type;return n.a.createElement(E,null,function(e){var a=e.movieSearchString,r=e.setMovieSearchString;return n.a.createElement("div",{className:"mb-3"},n.a.createElement("div",{className:"input-group input-group-sm mb-1"},n.a.createElement("input",{id:"search-movie",className:"form-control",placeholder:"Search...",type:"text",value:a,onChange:function(e){return r(e.target.value)}}),n.a.createElement("span",{className:"input-group-append"},n.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return r("")}},n.a.createElement(O.a,{icon:"times"})))),"Diary"===t&&n.a.createElement(R,null,function(e){var t=e.movieDiaryFiltered;return n.a.createElement("p",{className:"small text-right"},t.length," movies")}),"Ratings"===t&&n.a.createElement(P,null,function(e){var t=e.movieRatingsFiltered;return n.a.createElement("p",{className:"small text-right"},t.length," movies")}))})},H=function(e){var t=e.type;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"h4"},t),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12 col-sm-4"},n.a.createElement($,{type:t})),n.a.createElement("div",{className:"col-12 col-sm-8"},n.a.createElement(V,{type:t}))))},K=function(e){e.messages;return n.a.createElement(Y,{type:"pageNotFound"})},Q=function(e){var t=e.width;return n.a.createElement("div",{className:"bg-secondary rounded"},n.a.createElement("div",{className:"bg-danger pb-2 rounded",style:{width:"".concat(t,"%")}}))},X=function(e){var t=e.getMovies,a=e.moviesStatus,r=e.type,i=t(),o=[];if("loading"===a||"error"===a)o.push(n.a.createElement(Y,{key:a,type:a}));else if(i.groups){var s=function(e){var t=100*i.groups[e]/i.max;o.unshift(n.a.createElement("div",{className:"mb-2",key:e},n.a.createElement("div",{className:"no-gutters row"},n.a.createElement("div",{className:"col-auto"},function(){if("moviesPerRatingGiven"===r){for(var t=[],a=0;a<e;a++)t.push(n.a.createElement(O.a,{key:a,className:"mr-1 text-warning",icon:"star"}));return t}return e}()),n.a.createElement("div",{className:"col font-weight-bold text-right"},i.groups[e])),n.a.createElement(Q,{width:t})))};for(var c in i.groups)s(c)}else o.push(n.a.createElement(Y,{key:"noStats",type:"noStats"}));return o},Z=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"h4"},"Stats"),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per year watched"),n.a.createElement(R,null,function(e){var t=e.getMoviesPerYearWatched,a=e.movieDiaryStatus;return n.a.createElement(X,{getMovies:t,moviesStatus:a,type:"moviesPerYearWatched"})}))),n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per rating given"),n.a.createElement(P,null,function(e){var t=e.getMoviesPerRatingGiven,a=e.movieRatingsStatus;return n.a.createElement(X,{getMovies:t,moviesStatus:a,type:"moviesPerRatingGiven"})}))),n.a.createElement("div",{className:"col-12 col-sm-6 col-md-4 mb-3"},n.a.createElement("div",{className:"border border-secondary p-3 rounded"},n.a.createElement("h1",{className:"h5"},"Per decade released"),n.a.createElement(P,null,function(e){var t=e.getMoviesPerDecadeReleased,a=e.movieRatingsStatus;return n.a.createElement(X,{getMovies:t,moviesStatus:a,type:"moviesPerDecadeReleased"})})))))},ee=function(){return n.a.createElement("div",{className:"border-secondary border-top pt-3 small text-center"},n.a.createElement("div",{className:"mb-3"},"My Ratings and Diary data are exported from Letterboxd from time to time.",n.a.createElement("br",null),"So my ",n.a.createElement("a",{className:"text-danger",href:"https://letterboxd.com/saviomd",target:"_blank",rel:"noopener noreferrer"},"profile")," will have more up to date information."),n.a.createElement("div",{className:"mb-3"},n.a.createElement("img",{alt:"Powered by TMDB",className:"mr-1",src:L.img.attributionUrl,height:"32"}),n.a.createElement("br",null),"This product uses the TMDb API but is not endorsed or certified by TMDb."))};a(30);h.b.add(f.a,f.b,f.c,f.d,f.e,f.f,f.g,f.h);var te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(v.a)(t).call(this,e))).state={navLinks:[{icon:"star",name:"Ratings",path:"/"},{icon:"calendar-alt",name:"Diary",path:"/diary"},{icon:"chart-bar",name:"Stats",path:"/stats"}]},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(y,null,n.a.createElement(w,null,n.a.createElement(k,null,n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"justify-content-center row"},n.a.createElement("div",{className:"col-12 col-md-10"},n.a.createElement(C,{navLinks:this.state.navLinks}),n.a.createElement(d.a,null,n.a.createElement(g.a,{path:"/",exact:!0,render:function(){return n.a.createElement(H,{type:"Ratings"})}}),n.a.createElement(g.a,{path:"/diary",render:function(){return n.a.createElement(H,{type:"Diary"})}}),n.a.createElement(g.a,{path:"/movie/:movieId",render:function(e){var t=e.match;return n.a.createElement(B,{match:t})}}),n.a.createElement(g.a,{path:"/stats",render:function(){return n.a.createElement(Z,null)}}),n.a.createElement(g.a,{component:K})),n.a.createElement(ee,null),n.a.createElement(x,null)))))))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ae=n.a.createElement(s.a,null,n.a.createElement(te,null));o.a.render(ae,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.824db6a6.chunk.js.map