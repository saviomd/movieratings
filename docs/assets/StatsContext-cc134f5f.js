import{v as l,r,p as v,w as R,a as h}from"./index-bf65944b.js";const{poster:_}=l.img,A=({randomMovieList:o})=>[...o].map(t=>({...t,movie_path:`/movie/${t.LetterboxdURI.split("boxd.it/")[1]}`,poster_url:_({path:t.poster_path})})),E={randomMovies:[],randomMoviesStatus:""};function b(o,{payload:t,type:e}){switch(e){case"SET_RANDOM_MOVIES":return{...o,randomMovies:A({randomMovieList:t}),randomMoviesStatus:"loaded"};case"SET_RANDOM_MOVIES_STATUS":return{...o,randomMoviesStatus:t};default:throw new Error}}const x=()=>{const[o,t]=r.useReducer(b,E),e=r.useMemo(()=>({setRandomMovies:s=>t({type:"SET_RANDOM_MOVIES",payload:s}),setRandomMoviesStatus:s=>t({type:"SET_RANDOM_MOVIES_STATUS",payload:s})}),[]);return{...o,boundActions:e}},d=r.createContext(),O=()=>r.useContext(d);function T({children:o}){const t=x(),e=r.useCallback(({movies:a})=>{if(a.length){t.boundActions.setRandomMoviesStatus("loading");const c=a.map(({Name:n,Year:i})=>R({Name:n,Year:i}));Promise.all(c).then(n=>{if(n.length){const i=n.map(({results:u},p)=>{const{LetterboxdURI:S,Name:M}=a[p],{poster_path:m}=u[0];return{LetterboxdURI:S,Name:M,poster_path:m}});t.boundActions.setRandomMovies(i)}else throw Error("No movie found")}).catch(()=>{t.boundActions.setRandomMoviesStatus("error")})}else t.boundActions.setRandomMoviesStatus("error")},[t.boundActions]),s={...t,loadRandomMovies:e};return h(d.Provider,{value:s,children:o})}T.propTypes={children:v.node.isRequired};export{T as S,O as u};
